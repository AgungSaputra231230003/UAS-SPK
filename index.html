<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modern SAW Calculator - Pemilihan Rumah Terbaik</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
      :root {
        --primary: #4361ee;
        --secondary: #3f37c9;
        --accent: #4895ef;
        --success: #4caf50;
        --warning: #f44336;
        --light: #f8f9fa;
        --dark: #212529;
        --card-bg: rgba(255, 255, 255, 0.98);
        --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
        --border-radius: 12px;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #1e5799 0%, #207cca 51%, #2989d8 100%);
        color: var(--dark);
        line-height: 1.7;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: var(--card-bg);
        border-radius: var(--border-radius);
        box-shadow: var(--card-shadow);
        overflow: hidden;
        padding: 30px;
      }

      header {
        text-align: center;
        margin-bottom: 30px;
        padding: 40px 30px;
        background: linear-gradient(to right, var(--primary), var(--secondary));
        color: white;
        border-radius: var(--border-radius);
        position: relative;
        overflow: hidden;
      }

      header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(to right, #4cc9f0, #f72585);
      }

      header h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
        font-weight: 700;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      header h2 {
        font-size: 1.8rem;
        font-weight: 400;
        color: #f0f0f0;
        opacity: 0.9;
      }

      .description {
        background: linear-gradient(to right, rgba(67, 97, 238, 0.1), rgba(63, 55, 201, 0.1));
        padding: 25px;
        border-radius: var(--border-radius);
        margin-bottom: 30px;
        border-left: 5px solid var(--primary);
        backdrop-filter: blur(5px);
      }

      .description h3 {
        color: var(--primary);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 1.5rem;
      }

      .description p {
        margin-bottom: 12px;
        font-size: 1.1rem;
        color: #444;
        line-height: 1.6;
      }

      .input-section {
        background: linear-gradient(to bottom, #ffffff, #f9f9f9);
        padding: 30px;
        border-radius: var(--border-radius);
        margin-bottom: 30px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        border: 1px solid rgba(0, 0, 0, 0.05);
      }

      .input-section h3 {
        color: var(--secondary);
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid #eaeaea;
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 1.6rem;
      }

      .criteria,
      .alternative {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
        padding: 20px;
        background: linear-gradient(to bottom, #ffffff, #f5f7ff);
        border-radius: 10px;
        border: 1px solid #e0e0e0;
        transition: var(--transition);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
      }

      .criteria:hover,
      .alternative:hover {
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        transform: translateY(-3px);
        border-color: #bbdefb;
      }

      .criteria input,
      .alternative input {
        padding: 14px;
        border: 1px solid #ddd;
        border-radius: 8px;
        flex: 1;
        min-width: 150px;
        font-size: 16px;
        background-color: #f9f9f9;
        transition: var(--transition);
      }

      .criteria input:focus,
      .alternative input:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(72, 149, 239, 0.2);
        background-color: white;
      }

      .criteria select {
        padding: 14px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: white;
        min-width: 150px;
        font-size: 16px;
        transition: var(--transition);
      }

      .criteria select:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(72, 149, 239, 0.2);
      }

      button {
        padding: 14px 20px;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: var(--transition);
        font-size: 16px;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      }

      .remove-criteria,
      .remove-alternative {
        background: linear-gradient(to right, #ff6b6b, #ff4d6d);
        padding: 14px 20px;
      }

      .remove-criteria:hover,
      .remove-alternative:hover {
        background: linear-gradient(to right, #ff5c8a, #ff4d6d);
      }

      #add-criteria,
      #add-alternative {
        background: linear-gradient(to right, var(--accent), var(--primary));
        margin-top: 15px;
        width: 100%;
        justify-content: center;
        padding: 16px;
        font-size: 1.1rem;
      }

      #add-criteria:hover,
      #add-alternative:hover {
        background: linear-gradient(to right, #3a86ff, #4361ee);
      }

      .alternative-values {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        flex: 1;
      }

      .alternative-value {
        flex: 1;
        min-width: 120px;
      }

      #calculate-btn {
        background: linear-gradient(to right, #ff9800, #f57c00);
        padding: 16px 30px;
        font-size: 1.2rem;
        margin: 30px auto;
        display: block;
        width: 300px;
        justify-content: center;
        border-radius: 50px;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      }

      #calculate-btn:hover {
        background: linear-gradient(to right, #f57c00, #ef6c00);
        transform: translateY(-3px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }

      .results-section {
        margin-top: 30px;
        background: linear-gradient(to bottom, #ffffff, #f5f7ff);
        padding: 30px;
        border-radius: var(--border-radius);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        border: 1px solid rgba(0, 0, 0, 0.05);
        display: none;
      }

      .results-section h3 {
        color: var(--secondary);
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid #eaeaea;
        font-size: 1.8rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .results-section h4 {
        color: var(--primary);
        margin: 30px 0 20px;
        padding-bottom: 10px;
        border-bottom: 1px dashed #bbdefb;
        font-size: 1.4rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        margin-bottom: 30px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        border-radius: 10px;
        overflow: hidden;
      }

      th,
      td {
        padding: 16px;
        text-align: center;
        border: 1px solid #e0e0e0;
      }

      th {
        background: linear-gradient(to bottom, var(--primary), var(--secondary));
        color: white;
        font-weight: 500;
        position: sticky;
        top: 0;
        font-size: 1.1rem;
      }

      tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      tr:hover {
        background-color: #eef7ff;
      }

      .rank-1 {
        background: linear-gradient(to right, #e8f5e9, #d8f3dc) !important;
        font-weight: bold;
        color: #2e7d32;
        position: relative;
      }

      .rank-1::after {
        content: 'ðŸ†';
        position: absolute;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
      }

      .final-score {
        font-weight: bold;
        color: var(--secondary);
        font-size: 1.1rem;
      }

      .highlight {
        background: linear-gradient(to right, #f0f7ff, #d1e3ff);
        padding: 5px 12px;
        border-radius: 20px;
        font-weight: bold;
        color: var(--secondary);
        display: inline-block;
      }

      .unit-hint {
        font-size: 0.9em;
        color: #757575;
        font-weight: normal;
        display: block;
        margin-top: 3px;
      }

      .recommendation {
        background: linear-gradient(to right, #e8f5e9, #d8f3dc);
        padding: 30px;
        border-radius: var(--border-radius);
        margin-top: 30px;
        border-left: 5px solid var(--success);
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .recommendation::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(to right, var(--success), #4cc9f0);
      }

      .recommendation h4 {
        color: #2e7d32;
        font-size: 1.6rem;
        margin-bottom: 20px;
      }

      .best-alternative {
        font-size: 1.8rem;
        color: var(--secondary);
        font-weight: bold;
        margin: 15px 0;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
      }

      .footer {
        text-align: center;
        margin-top: 40px;
        padding-top: 25px;
        color: #666;
        font-size: 1rem;
        border-top: 1px solid #eee;
      }

      .section-title {
        display: flex;
        align-items: center;
        gap: 12px;
        padding-bottom: 15px;
        margin-bottom: 25px;
        border-bottom: 2px solid #eaeaea;
        color: var(--secondary);
        font-size: 1.6rem;
      }

      .section-title i {
        background: linear-gradient(to bottom, var(--accent), var(--primary));
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
      }

      /* Fasilitas checkbox styles */
      .facilities-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
      }

      .facility-option {
        display: flex;
        align-items: center;
        background: #f0f4ff;
        padding: 8px 12px;
        border-radius: 20px;
        border: 1px solid #d0d7ff;
      }

      .facility-option input {
        margin-right: 8px;
        min-width: auto;
      }

      .facility-option label {
        font-size: 0.9rem;
        cursor: pointer;
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .criteria,
        .alternative {
          flex-direction: column;
          align-items: stretch;
        }

        .criteria > *,
        .alternative > * {
          width: 100%;
        }

        .alternative-values {
          flex-direction: column;
        }

        table {
          display: block;
          overflow-x: auto;
        }

        header h1 {
          font-size: 2.2rem;
        }

        header h2 {
          font-size: 1.4rem;
        }

        #calculate-btn {
          width: 100%;
          max-width: 300px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1><i class="fas fa-home"></i> Sistem Pendukung Keputusan Pemilihan Rumah</h1>
        <h2>Metode SAW (Simple Additive Weighting)</h2>
      </header>

      <div class="description">
        <h3><i class="fas fa-info-circle"></i> Petunjuk Penggunaan</h3>
        <p>1. Tambahkan kriteria penilaian rumah beserta bobot dan satuan unitnya.</p>
        <p>2. Untuk kriteria "Harga", gunakan satuan juta (contoh: 500 untuk 500 juta).</p>
        <p>3. Untuk fasilitas, pilih fasilitas yang tersedia di rumah tersebut.</p>
        <p>4. Klik tombol "Hitung Ranking" untuk melihat hasil perhitungan.</p>
        <p>5. Sistem akan menampilkan peringkat rumah berdasarkan skor akhir.</p>
      </div>

      <div class="input-section">
        <h3 class="section-title"><i class="fas fa-list-alt"></i> 1. Input Kriteria dan Bobot</h3>
        <div id="criteria-container">
          <div class="criteria">
            <input type="text" placeholder="Nama Kriteria" class="nama-criteria" value="Harga" />
            <select class="criteria-type">
              <option value="cost" selected>Cost</option>
              <option value="benefit">Benefit</option>
            </select>
            <input type="number" placeholder="Bobot (1-100)" class="criteria-weight" min="1" max="100" value="30" />
            <input type="text" placeholder="Satuan" class="criteria-unit" value="juta" />
            <button class="remove-criteria"><i class="fas fa-trash"></i> Hapus</button>
          </div>
          <div class="criteria">
            <input type="text" placeholder="Nama Kriteria" class="nama-criteria" value="Jarak ke Pusat Kota" />
            <select class="criteria-type">
              <option value="cost" selected>Cost</option>
              <option value="benefit">Benefit</option>
            </select>
            <input type="number" placeholder="Bobot (1-100)" class="criteria-weight" min="1" max="100" value="25" />
            <input type="text" placeholder="Satuan" class="criteria-unit" value="km" />
            <button class="remove-criteria"><i class="fas fa-trash"></i> Hapus</button>
          </div>
          <div class="criteria">
            <input type="text" placeholder="Nama Kriteria" class="nama-criteria" value="Fasilitas" />
            <select class="criteria-type">
              <option value="cost">Cost</option>
              <option value="benefit" selected>Benefit</option>
            </select>
            <input type="number" placeholder="Bobot (1-100)" class="criteria-weight" min="1" max="100" value="20" />
            <input type="text" placeholder="Satuan" class="criteria-unit" value="" />
            <button class="remove-criteria"><i class="fas fa-trash"></i> Hapus</button>
          </div>
          <div class="criteria">
            <input type="text" placeholder="Nama Kriteria" class="nama-criteria" value="Luas Tanah" />
            <select class="criteria-type">
              <option value="cost">Cost</option>
              <option value="benefit" selected>Benefit</option>
            </select>
            <input type="number" placeholder="Bobot (1-100)" class="criteria-weight" min="1" max="100" value="15" />
            <input type="text" placeholder="Satuan" class="criteria-unit" value="mÂ²" />
            <button class="remove-criteria"><i class="fas fa-trash"></i> Hapus</button>
          </div>
          <div class="criteria">
            <input type="text" placeholder="Nama Kriteria" class="nama-criteria" value="Keamanan" />
            <select class="criteria-type">
              <option value="cost">Cost</option>
              <option value="benefit" selected>Benefit</option>
            </select>
            <input type="number" placeholder="Bobot (1-100)" class="criteria-weight" min="1" max="100" value="10" />
            <input type="text" placeholder="Satuan" class="criteria-unit" value="%" />
            <button class="remove-criteria"><i class="fas fa-trash"></i> Hapus</button>
          </div>
        </div>
        <button id="add-criteria"><i class="fas fa-plus-circle"></i> Tambah Kriteria Rumah</button>
      </div>

      <div class="input-section">
        <h3 class="section-title"><i class="fas fa-list-ol"></i> 2. Input Alternatif Pemilihan Rumah</h3>
        <div id="alternatives-container">
          <div class="alternative">
            <input type="text" placeholder="Nama Rumah" class="alternative-name" value="Perumahan Asri" />
            <div class="alternative-values">
              <input type="number" placeholder="Harga (juta)" class="alternative-value" value="500" />
              <input type="number" placeholder="Jarak ke Pusat Kota (km)" class="alternative-value" value="5" />
              <div class="facility-container">
                <p style="margin-bottom: 10px;">Fasilitas:</p>
                <div class="facilities-container">
                  <div class="facility-option">
                    <input type="checkbox" id="facility1-1" class="facility-checkbox" checked>
                    <label for="facility1-1">Taman Belakang</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility1-2" class="facility-checkbox" checked>
                    <label for="facility1-2">WC dalam Kamar</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility1-3" class="facility-checkbox" checked>
                    <label for="facility1-3">Garasi Mobil</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility1-4" class="facility-checkbox">
                    <label for="facility1-4">Kolam Renang</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility1-5" class="facility-checkbox">
                    <label for="facility1-5">Gym</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility1-6" class="facility-checkbox" checked>
                    <label for="facility1-6">Dapur Modern</label>
                  </div>
                </div>
              </div>
              <input type="number" placeholder="Luas Tanah (mÂ²)" class="alternative-value" value="100" />
              <input type="number" placeholder="Keamanan (%)" class="alternative-value" value="95" />
            </div>
            <button class="remove-alternative"><i class="fas fa-trash"></i> Hapus</button>
          </div>
          <div class="alternative">
            <input type="text" placeholder="Nama Rumah" class="alternative-name" value="Perumahan GreenPark" />
            <div class="alternative-values">
              <input type="number" placeholder="Harga (juta)" class="alternative-value" value="750" />
              <input type="number" placeholder="Jarak ke Pusat Kota (km)" class="alternative-value" value="10" />
              <div class="facility-container">
                <p style="margin-bottom: 10px;">Fasilitas:</p>
                <div class="facilities-container">
                  <div class="facility-option">
                    <input type="checkbox" id="facility2-1" class="facility-checkbox" checked>
                    <label for="facility2-1">Taman Belakang</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility2-2" class="facility-checkbox" checked>
                    <label for="facility2-2">WC dalam Kamar</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility2-3" class="facility-checkbox" checked>
                    <label for="facility2-3">Garasi Mobil</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility2-4" class="facility-checkbox" checked>
                    <label for="facility2-4">Kolam Renang</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility2-5" class="facility-checkbox">
                    <label for="facility2-5">Gym</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility2-6" class="facility-checkbox" checked>
                    <label for="facility2-6">Dapur Modern</label>
                  </div>
                </div>
              </div>
              <input type="number" placeholder="Luas Tanah (mÂ²)" class="alternative-value" value="120" />
              <input type="number" placeholder="Keamanan (%)" class="alternative-value" value="100" />
            </div>
            <button class="remove-alternative"><i class="fas fa-trash"></i> Hapus</button>
          </div>
          <div class="alternative">
            <input type="text" placeholder="Nama Rumah" class="alternative-name" value="Perumahan CitraLand" />
            <div class="alternative-values">
              <input type="number" placeholder="Harga (juta)" class="alternative-value" value="1200" />
              <input type="number" placeholder="Jarak ke Pusat Kota (km)" class="alternative-value" value="15" />
              <div class="facility-container">
                <p style="margin-bottom: 10px;">Fasilitas:</p>
                <div class="facilities-container">
                  <div class="facility-option">
                    <input type="checkbox" id="facility3-1" class="facility-checkbox" checked>
                    <label for="facility3-1">Taman Belakang</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility3-2" class="facility-checkbox" checked>
                    <label for="facility3-2">WC dalam Kamar</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility3-3" class="facility-checkbox" checked>
                    <label for="facility3-3">Garasi Mobil</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility3-4" class="facility-checkbox" checked>
                    <label for="facility3-4">Kolam Renang</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility3-5" class="facility-checkbox" checked>
                    <label for="facility3-5">Gym</label>
                  </div>
                  <div class="facility-option">
                    <input type="checkbox" id="facility3-6" class="facility-checkbox" checked>
                    <label for="facility3-6">Dapur Modern</label>
                  </div>
                </div>
              </div>
              <input type="number" placeholder="Luas Tanah (mÂ²)" class="alternative-value" value="150" />
              <input type="number" placeholder="Keamanan (%)" class="alternative-value" value="100" />
            </div>
            <button class="remove-alternative"><i class="fas fa-trash"></i> Hapus</button>
          </div>
        </div>
        <button id="add-alternative"><i class="fas fa-plus-circle"></i> Tambah Alternatif Rumah</button>
      </div>

      <button id="calculate-btn"><i class="fas fa-calculator"></i> Hitung Ranking</button>

      <div id="results" class="results-section">
        <h3><i class="fas fa-chart-bar"></i> Hasil Perhitungan</h3>
        <div id="normalization-matrix"></div>
        <div id="weighted-matrix"></div>
        <div id="final-results"></div>

        <div class="recommendation" id="recommendation">
          <h4><i class="fas fa-trophy"></i> Rekomendasi Terbaik</h4>
          <p>Berdasarkan perhitungan dengan metode SAW, rumah terbaik untuk Anda adalah:</p>
          <p class="best-alternative" id="best-alternative">Perumahan Asri</p>
          <p>dengan skor akhir <span class="highlight" id="best-score">0.7500</span></p>
        </div>
      </div>

      <div class="footer">
        <p>Sistem Pendukung Keputusan Pemilihan Rumah &copy; 2025 | Metode SAW (Simple Additive Weighting)</p>
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Elemen DOM
        const criteriaContainer = document.getElementById('criteria-container');
        const alternativesContainer = document.getElementById('alternatives-container');
        const addcriteriaBtn = document.getElementById('add-criteria');
        const addAlternativeBtn = document.getElementById('add-alternative');
        const calculateBtn = document.getElementById('calculate-btn');
        const resultsSection = document.getElementById('results');
        const normalizationMatrix = document.getElementById('normalization-matrix');
        const weightedMatrix = document.getElementById('weighted-matrix');
        const finalResults = document.getElementById('final-results');
        const bestAlternativeEl = document.getElementById('best-alternative');
        const bestScoreEl = document.getElementById('best-score');
        const recommendationEl = document.getElementById('recommendation');

        // Fasilitas yang tersedia
        const facilityOptions = [
          { id: 'taman', label: 'Taman Belakang', value: 1 },
          { id: 'wc', label: 'WC dalam Kamar', value: 2 },
          { id: 'garasi', label: 'Garasi Mobil', value: 3 },
          { id: 'kolam', label: 'Kolam Renang', value: 4 },
          { id: 'gym', label: 'Gym', value: 5 },
          { id: 'dapur', label: 'Dapur Modern', value: 6 }
        ];

        // Event Listeners
        addcriteriaBtn.addEventListener('click', addcriteria);
        addAlternativeBtn.addEventListener('click', addAlternative);
        calculateBtn.addEventListener('click', calculateSAW);

        // Inisialisasi
        init();

        function init() {
          // untuk menghapus kriteria dan alternatif
          document.querySelectorAll('.remove-criteria').forEach((button) => {
            button.addEventListener('click', function () {
              this.closest('.criteria').remove();
              updateAlternativeValueInputs();
            });
          });

          document.querySelectorAll('.remove-alternative').forEach((button) => {
            button.addEventListener('click', function () {
              this.closest('.alternative').remove();
            });
          });

          // Update placeholder untuk input nilai
          updateAlternativeValueInputs();
        }

        // Fungsi tambah kriteria
        function addcriteria() {
          const criteriaDiv = document.createElement('div');
          criteriaDiv.className = 'criteria';
          criteriaDiv.innerHTML = `
                    <input type="text" placeholder="Nama Kriteria" class="nama-criteria">
                    <select class="criteria-type">
                        <option value="benefit">Benefit</option>
                        <option value="cost" selected>Cost</option>
                    </select>
                    <input type="number" placeholder="Bobot (1-100)" class="criteria-weight" min="1" max="100" value="10">
                    <input type="text" placeholder="Satuan" class="criteria-unit">
                    <button class="remove-criteria"><i class="fas fa-trash"></i> Hapus</button>
                `;
          criteriaContainer.appendChild(criteriaDiv);

          criteriaDiv.querySelector('.remove-criteria').addEventListener('click', function () {
            criteriaContainer.removeChild(criteriaDiv);
            updateAlternativeValueInputs();
          });

          updateAlternativeValueInputs();
        }

        // Fungsi tambah alternatif
        function addAlternative() {
          const alternativeDiv = document.createElement('div');
          alternativeDiv.className = 'alternative';

          const nameInput = document.createElement('input');
          nameInput.type = 'text';
          nameInput.placeholder = 'Nama Perumahan';
          nameInput.className = 'alternative-name';

          const valuesDiv = document.createElement('div');
          valuesDiv.className = 'alternative-values';

          const criteriaDivs = criteriaContainer.querySelectorAll('.criteria');
          criteriaDivs.forEach((criteria, index) => {
            const NamaCriteria = criteria.querySelector('.nama-criteria').value;
            const unit = criteria.querySelector('.criteria-unit').value || '';

            // Jika kriteria adalah Fasilitas, buat checkbox
            if (NamaCriteria.toLowerCase() === 'fasilitas') {
              const facilityContainer = document.createElement('div');
              facilityContainer.className = 'facility-container';
              
              const label = document.createElement('p');
              label.style.marginBottom = '10px';
              label.textContent = 'Fasilitas:';
              facilityContainer.appendChild(label);
              
              const facilitiesDiv = document.createElement('div');
              facilitiesDiv.className = 'facilities-container';
              
              facilityOptions.forEach((facility, i) => {
                const facilityOption = document.createElement('div');
                facilityOption.className = 'facility-option';
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `facility-new-${i}`;
                checkbox.className = 'facility-checkbox';
                
                const label = document.createElement('label');
                label.htmlFor = `facility-new-${i}`;
                label.textContent = facility.label;
                
                facilityOption.appendChild(checkbox);
                facilityOption.appendChild(label);
                facilitiesDiv.appendChild(facilityOption);
              });
              
              facilityContainer.appendChild(facilitiesDiv);
              valuesDiv.appendChild(facilityContainer);
            } else {
              // Untuk kriteria lainnya, buat input number biasa
              const valueInput = document.createElement('input');
              valueInput.type = 'number';

              // Tentukan placeholder berdasarkan nama kriteria dan satuan
              if (unit) {
                valueInput.placeholder = `${NamaCriteria} (${unit})`;
              } else {
                valueInput.placeholder = NamaCriteria;
              }

              valueInput.className = 'alternative-value';
              valueInput.dataset.CriteriaIndex = index;
              valuesDiv.appendChild(valueInput);
            }
          });

          const removeBtn = document.createElement('button');
          removeBtn.className = 'remove-alternative';
          removeBtn.innerHTML = '<i class="fas fa-trash"></i> Hapus';

          alternativeDiv.appendChild(nameInput);
          alternativeDiv.appendChild(valuesDiv);
          alternativeDiv.appendChild(removeBtn);

          alternativesContainer.appendChild(alternativeDiv);

          removeBtn.addEventListener('click', function () {
            alternativesContainer.removeChild(alternativeDiv);
          });
        }

        // Update input nilai alternatif
        function updateAlternativeValueInputs() {
          const alternativeDivs = alternativesContainer.querySelectorAll('.alternative');
          const criteriaDivs = criteriaContainer.querySelectorAll('.criteria');

          alternativeDivs.forEach((alternativeDiv) => {
            const valuesDiv = alternativeDiv.querySelector('.alternative-values');
            const currentValues = [];

            // Simpan nilai yang sudah ada
            const existingInputs = valuesDiv.querySelectorAll('.alternative-value, .facility-container');
            existingInputs.forEach((input) => {
              if (input.classList.contains('facility-container')) {
                const checkboxes = input.querySelectorAll('.facility-checkbox');
                const checkedValues = Array.from(checkboxes).map(cb => cb.checked);
                currentValues.push({
                  type: 'facility',
                  values: checkedValues
                });
              } else {
                currentValues.push({
                  type: 'value',
                  value: input.value,
                  placeholder: input.placeholder,
                });
              }
            });

            valuesDiv.innerHTML = '';

            criteriaDivs.forEach((criteria, index) => {
              const NamaCriteria = criteria.querySelector('.nama-criteria').value;
              const unit = criteria.querySelector('.criteria-unit').value || '';

              // Jika kriteria adalah Fasilitas, buat checkbox
              if (NamaCriteria.toLowerCase() === 'fasilitas') {
                const facilityContainer = document.createElement('div');
                facilityContainer.className = 'facility-container';
                
                const label = document.createElement('p');
                label.style.marginBottom = '10px';
                label.textContent = 'Fasilitas:';
                facilityContainer.appendChild(label);
                
                const facilitiesDiv = document.createElement('div');
                facilitiesDiv.className = 'facilities-container';
                
                facilityOptions.forEach((facility, i) => {
                  const facilityOption = document.createElement('div');
                  facilityOption.className = 'facility-option';
                  
                  const checkbox = document.createElement('input');
                  checkbox.type = 'checkbox';
                  checkbox.id = `facility-${alternativeDivs.length}-${i}`;
                  checkbox.className = 'facility-checkbox';
                  
                  // Set nilai checkbox jika ada data sebelumnya
                  if (currentValues[index]?.type === 'facility' && currentValues[index].values[i]) {
                    checkbox.checked = true;
                  }
                  
                  const label = document.createElement('label');
                  label.htmlFor = `facility-${alternativeDivs.length}-${i}`;
                  label.textContent = facility.label;
                  
                  facilityOption.appendChild(checkbox);
                  facilityOption.appendChild(label);
                  facilitiesDiv.appendChild(facilityOption);
                });
                
                facilityContainer.appendChild(facilitiesDiv);
                valuesDiv.appendChild(facilityContainer);
              } else {
                // Untuk kriteria lainnya, buat input number biasa
                const valueInput = document.createElement('input');
                valueInput.type = 'number';

                // Tentukan placeholder berdasarkan nama kriteria dan satuan
                if (unit) {
                  valueInput.placeholder = `${NamaCriteria} (${unit})`;
                } else {
                  valueInput.placeholder = NamaCriteria;
                }

                valueInput.className = 'alternative-value';
                valueInput.dataset.CriteriaIndex = index;

                // Pertahankan nilai yang sudah ada jika masih sesuai
                if (currentValues[index]?.type === 'value') {
                  valueInput.value = currentValues[index].value;
                }

                valuesDiv.appendChild(valueInput);
              }
            });
          });
        }

        // Fungsi utama SAW
        function calculateSAW() {
          // Ambil data kriteria dari form
          const criteria = [];
          const criteriaDivs = criteriaContainer.querySelectorAll('.criteria');

          criteriaDivs.forEach((criteriaDiv, index) => {
            const name = criteriaDiv.querySelector('.nama-criteria').value || `Kriteria ${index + 1}`;
            const type = criteriaDiv.querySelector('.criteria-type').value;
            const weight = parseFloat(criteriaDiv.querySelector('.criteria-weight').value) || 1;
            const unit = criteriaDiv.querySelector('.criteria-unit').value || '';

            criteria.push({
              name,
              type,
              weight,
              unit,
              normalizedWeight: 0,
            });
          });

          // Normalisasi bobot
          const totalWeight = criteria.reduce((sum, criteria) => sum + criteria.weight, 0);
          criteria.forEach((criteria) => {
            criteria.normalizedWeight = criteria.weight / totalWeight;
          });

          // Ambil data alternatif dari form
          const alternatives = [];
          const alternativeDivs = alternativesContainer.querySelectorAll('.alternative');

          alternativeDivs.forEach((alternativeDiv, altIndex) => {
            const name = alternativeDiv.querySelector('.alternative-name').value || `Alternatif ${altIndex + 1}`;
            const values = [];

            const criteriaDivs = criteriaContainer.querySelectorAll('.criteria');
            criteriaDivs.forEach((criteriaDiv, critIndex) => {
              const NamaCriteria = criteriaDiv.querySelector('.nama-criteria').value;
              
              // Jika kriteria adalah Fasilitas, hitung jumlah fasilitas yang dipilih
              if (NamaCriteria.toLowerCase() === 'fasilitas') {
                const facilityContainer = alternativeDiv.querySelector('.facility-container');
                const checkboxes = facilityContainer.querySelectorAll('.facility-checkbox');
                const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
                values.push(checkedCount);
              } else {
                // Untuk kriteria lainnya, ambil nilai dari input number
                const valueInputs = alternativeDiv.querySelectorAll('.alternative-value');
                let value = parseFloat(valueInputs[critIndex]?.value) || 0;

                // Konversi ke satuan yang sesuai jika kriteria adalah harga
                if (criteria[critIndex]?.unit === 'juta') {
                  value = value * 1000000; // Konversi juta ke rupiah
                }

                values.push(value);
              }
            });

            alternatives.push({
              name,
              values,
              normalizedValues: [],
              weightedValues: [],
              finalScore: 0,
              rank: 0,
            });
          });

          // 1. Normalisasi matriks
          const normalizedMatrix = normalizeMatrix(alternatives, criteria);

          // 2. Hitung matriks terbobot
          const weightedMatrix = calculateWeightedMatrix(normalizedMatrix, criteria);

          // 3. Hitung skor akhir
          calculateFinalScores(alternatives, criteria);

          // 4. Ranking
          rankAlternatives(alternatives);

          // Tampilkan hasil
          displayResults(normalizedMatrix, weightedMatrix, alternatives, criteria);
          resultsSection.style.display = 'block';

          // Tampilkan rekomendasi terbaik
          if (alternatives.length > 0) {
            bestAlternativeEl.textContent = alternatives[0].name;
            bestScoreEl.textContent = alternatives[0].finalScore.toFixed(4);
            recommendationEl.style.display = 'block';
          }
        }

        // Normalisasi matriks
        function normalizeMatrix(alternatives, criteria) {
          const maxValues = [];
          const minValues = [];

          criteria.forEach((criteria, critIndex) => {
            const values = alternatives.map((alt) => alt.values[critIndex]);
            maxValues.push(Math.max(...values));
            minValues.push(Math.min(...values));
          });

          alternatives.forEach((alternative) => {
            alternative.normalizedValues = [];

            criteria.forEach((criteria, critIndex) => {
              const value = alternative.values[critIndex];
              let normalizedValue;

              if (criteria.type === 'benefit') {
                normalizedValue = value / maxValues[critIndex];
              } else {
                normalizedValue = minValues[critIndex] / value;
              }

              if (isNaN(normalizedValue)) normalizedValue = 0;
              if (!isFinite(normalizedValue)) normalizedValue = 0;

              alternative.normalizedValues.push(normalizedValue);
            });
          });

          return { alternatives, maxValues, minValues };
        }

        // Matriks terbobot
        function calculateWeightedMatrix(normalizedMatrix, criteria) {
          normalizedMatrix.alternatives.forEach((alternative) => {
            alternative.weightedValues = [];

            criteria.forEach((criteria, critIndex) => {
              const weightedValue = alternative.normalizedValues[critIndex] * criteria.normalizedWeight;
              alternative.weightedValues.push(weightedValue);
            });
          });

          return normalizedMatrix;
        }

        // Skor akhir
        function calculateFinalScores(alternatives, criteria) {
          alternatives.forEach((alternative) => {
            alternative.finalScore = alternative.weightedValues.reduce((sum, value) => sum + value, 0);
          });
        }

        // Ranking
        function rankAlternatives(alternatives) {
          alternatives.sort((a, b) => b.finalScore - a.finalScore);
          alternatives.forEach((alternative, index) => {
            alternative.rank = index + 1;
          });
        }

        // Tampilkan hasil
        function displayResults(normalizedMatrix, weightedMatrix, alternatives, criteria) {
          normalizationMatrix.innerHTML = `
                    <h4><i class="fas fa-table"></i> Matriks Normalisasi</h4>
                    ${createMatrixTable(normalizedMatrix.alternatives, criteria, 'normalizedValues', 'Perumahan')}
                `;

          weightedMatrix.innerHTML = `
                    <h4><i class="fas fa-calculator"></i> Matriks Terbobot</h4>
                    ${createMatrixTable(weightedMatrix.alternatives, criteria, 'weightedValues', 'Perumahan')}
                `;

          finalResults.innerHTML = `
                    <h4><i class="fas fa-trophy"></i> Hasil Akhir Ranking</h4>
                    ${createResultsTable(alternatives)}
                `;
        }

        // Buat tabel matriks
        function createMatrixTable(items, criteriaArray, valueType, rowHeader) {
          if (criteriaArray.length === 0 || items.length === 0) return '<p>Tidak ada data</p>';

          let html = '<table><tr><th>' + rowHeader + '</th>';

          criteriaArray.forEach((criteria) => {
            let displayName = criteria.name;

            // Tambahkan satuan untuk kriteria tertentu
            if (criteria.unit) {
              displayName += ` (${criteria.unit})`;
            }

            html += `<th>${displayName}<br>(${criteria.type === 'benefit' ? 'Benefit' : 'Cost'})</th>`;
          });

          html += '</tr>';

          items.forEach((item) => {
            html += `<tr><td>${item.name}</td>`;

            item[valueType].forEach((value, index) => {
              const criteria = criteriaArray[index];
              let displayValue;

              // Format khusus untuk nilai persentase
              if (criteria.unit === '%') {
                displayValue = (value * 100).toFixed(2) + '%';
              } else {
                displayValue = value.toFixed(4);
              }

              html += `<td>${displayValue}</td>`;
            });

            html += '</tr>';
          });

          html += '</table>';
          return html;
        }

        // Buat tabel hasil
        function createResultsTable(alternatives) {
          if (alternatives.length === 0) return '<p>Tidak ada data</p>';

          let html = `
                    <table>
                        <tr>
                            <th>Peringkat</th>
                            <th>Perumahan</th>
                            <th>Skor Akhir</th>
                        </tr>
                `;

          alternatives.forEach((alternative, index) => {
            const rowClass = index === 0 ? 'rank-1' : '';
            html += `
                        <tr class="${rowClass}">
                            <td>${alternative.rank}</td>
                            <td>${alternative.name}</td>
                            <td class="final-score">${alternative.finalScore.toFixed(4)}</td>
                        </tr>
                    `;
          });

          html += '</table>';
          return html;
        }
      });
    </script>
  </body>
</html>